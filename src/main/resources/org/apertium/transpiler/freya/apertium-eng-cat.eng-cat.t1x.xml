<?xml version="1.0" encoding="UTF-8"?>
<transfer default="chunk">
    <section-def-cats>
        <def-cat n="det">
            <cat-item tags="det.dem.*"/>
        </def-cat>
    </section-def-cats>
    <section-def-attrs>
        <def-attr n="a_nom">
            <attr-item tags="n"/>
            <attr-item tags="n.acr"/>
            <attr-item tags="np.loc"/>
            <attr-item tags="np.ant"/>
            <attr-item tags="np.cog"/>
            <attr-item tags="np.al"/>
            <attr-item tags="adv"/>
        </def-attr>
        <def-attr n="a_det">
            <attr-item tags="det.def"/>
        </def-attr>
        <def-attr n="gen_sense_mf">
            <attr-item tags="m"/>
            <attr-item tags="f"/>
            <attr-item tags="GD"/>
            <attr-item tags="nt"/>
        </def-attr>
        <def-attr n="gen_mf">
            <attr-item tags="mf"/>
        </def-attr>
        <def-attr n="nbr_sense_sp">
            <attr-item tags="sg"/>
            <attr-item tags="pl"/>
            <attr-item tags="ND"/>
        </def-attr>
        <def-attr n="nbr_sp">
            <attr-item tags="sp"/>
        </def-attr>
    </section-def-attrs>
    <section-def-vars>
        <def-var n="negative"/>
        <def-var n="nbr_chunk"/>
        <def-var n="gen_chunk"/>
        <def-var n="tipus_det"/>
    </section-def-vars>
    <section-def-lists/>
    <section-def-macros>
        <def-macro n="det_no" npar="2">
            <!--No cars ->cap cotxe (canvia nombre del nom de pl a sg) -->
            <choose>
                <when>
                    <test>
                        <and>
                            <equal caseless="yes">
                                <clip part="lem" pos="1" side="sl"/>
                                <lit v="no"/>
                            </equal>
                            <equal>
                                <clip part="nbr" pos="2" side="sl"/>
                                <lit-tag v="pl"/>
                            </equal>
                        </and>
                    </test>
                    <let>
                        <clip part="nbr" pos="2" side="tl"/>
                        <lit-tag v="sg"/>
                    </let>
                    <let>
                        <!-- BCN -->
                        <var n="negative"/>
                        <lit-tag v="negacio"/>
                    </let>
                </when>
                <when>
                    <test>
                        <and>
                            <equal caseless="yes">
                                <clip part="lem" pos="1" side="sl"/>
                                <lit v="no"/>
                            </equal>
                            <equal>
                                <clip part="nbr" pos="2" side="sl"/>
                                <lit-tag v="sg"/>
                            </equal>
                        </and>
                    </test>
                    <let>
                        <!-- BCN -->
                        <var n="negative"/>
                        <lit-tag v="negacio"/>
                    </let>
                </when>
                <otherwise>
                    <let>
                        <var n="negative"/>
                        <lit v=""/>
                    </let>
                </otherwise>
            </choose>
        </def-macro>
    </section-def-macros>
    <section-rules>
        <rule comment="REGLA: DET NOM">
            <pattern>
                <pattern-item n="det"/>
                <pattern-item n="nom"/>
            </pattern>
            <action>
                <call-macro n="det_no">
                    <with-param pos="1"/>
                    <with-param pos="2"/>
                </call-macro>
                <call-macro n="f_concord2">
                    <with-param pos="2"/>
                    <with-param pos="1"/>
                </call-macro>
                <call-macro n="firstWord">
                    <with-param pos="1"/>
                </call-macro>
                <call-macro n="determiner">
                    <with-param pos="1"/>
                </call-macro>
                <out>
                    <chunk case="caseFirstWord" name="det_nom">
                        <tags>
                            <tag>
                                <lit-tag v="SN"/>
                            </tag>
                            <tag>
                                <var n="tipus_det"/>
                            </tag>
                            <tag>
                                <var n="gen_chunk"/>
                            </tag>
                            <tag>
                                <var n="nbr_chunk"/>
                            </tag>
                            <tag>
                                <var n="negative"/>
                            </tag>
                            <!-- BCN per recollir si es negacio-->
                        </tags>
                        <lu>
                            <clip part="lem" pos="1" side="tl"/>
                            <clip part="a_det" pos="1" side="tl"/>
                            <clip link-to="3" part="gen_sense_mf" pos="1" side="tl"/>
                            <clip part="gen_mf" pos="1" side="tl"/>
                            <clip link-to="4" part="nbr_sense_sp" pos="1" side="tl"/>
                            <clip part="nbr_sp" pos="1" side="tl"/>
                        </lu>
                        <b pos="1"/>
                        <lu>
                            <clip part="lemh" pos="2" side="tl"/>
                            <clip part="a_nom" pos="2" side="tl"/>
                            <clip link-to="3" part="gen_sense_mf" pos="2" side="tl"/>
                            <clip part="gen_mf" pos="2" side="tl"/>
                            <clip link-to="4" part="nbr_sense_sp" pos="2" side="tl"/>
                            <clip part="nbr_sp" pos="2" side="tl"/>
                            <clip part="lemq" pos="2" side="tl"/>
                        </lu>
                    </chunk>
                </out>
            </action>
        </rule>
    </section-rules>
</transfer>