<?xml version="1.0" encoding="UTF-8"?>
<transfer default="chunk">
    <section-def-cats>
    
        <def-cat n="to"><!--BCN-->
            <cat-item lemma="to" tags="pr"/>
        </def-cat>
    
        <def-cat n="interj">
            <cat-item tags="ij"/>
        </def-cat>
        <def-cat n="on">
            <cat-item lemma="on" tags="pr"/>
            <cat-item lemma="on" tags="adv"/>
        </def-cat>
    
        <def-cat n="enough"><!--BCN-->
            <cat-item lemma="enough" tags="adv"/>
        </def-cat>
    
        <def-cat n="detquant"><!--BCN-->
            <cat-item tags="det.qnt.*"/>
        </def-cat>
    
        <def-cat n="all"><!--BCN-->
            <cat-item lemma="all" tags="predet.sp"/>
        </def-cat>
    
        <def-cat n="nomplural"><!--BCN-->
            <cat-item tags="n.pl"/>
        </def-cat>
    
        <def-cat n="nom">
            <cat-item tags="n.*"/>
            <cat-item tags="np.*"/>
        </def-cat>
    
        <def-cat n="months">
            <cat-item lemma="january" tags="n.*"/>
            <cat-item lemma="february" tags="n.*"/>
            <cat-item lemma="march" tags="n.*"/>
            <cat-item lemma="march" tags="np.cog.*"/>
            <cat-item lemma="april" tags="n.*"/>
            <cat-item lemma="may" tags="n.*"/>
            <cat-item lemma="june" tags="n.*"/>
            <cat-item lemma="july" tags="n.*"/>
            <cat-item lemma="august" tags="n.*"/>
            <cat-item lemma="september" tags="n.*"/>
            <cat-item lemma="october" tags="n.*"/>
            <cat-item lemma="november" tags="n.*"/>
            <cat-item lemma="december" tags="n.*"/>
        </def-cat>
    
        <def-cat n="nomcomu">
            <cat-item tags="n.*"/>
        </def-cat>
    
        <def-cat n="nompropi">
            <cat-item tags="np.*"/>
        </def-cat>
        <def-cat n="nploc">
            <cat-item tags="np.loc.*"/>
        </def-cat>
    
        <def-cat n="adj">
            <cat-item tags="adj"/>
            <cat-item tags="adj.*"/>
            <cat-item tags="adj.comp"/>
            <cat-item tags="adj.sup"/>
            <cat-item tags="adj.pos"/>
            <cat-item tags="adj.sint"/>
            <cat-item tags="adj.sint.*"/>
            <cat-item tags="vblex.pp"/> <!-- BCN ok implica tocar les regles per la concordança-->
            <cat-item tags="vbmod.pp"/> <!-- BCN ok implica tocar les regles per la concordança-->
        </def-cat>
    
        <def-cat n="adj2"><!--revisar regles amb 'adj' i 'adj2' -->
            <cat-item tags="adj"/>
            <cat-item tags="adj.*"/>
            <cat-item tags="adj.sint"/>
            <cat-item tags="adj.sint.*"/>
            <cat-item tags="adj.comp"/>
            <cat-item tags="adj.sup"/>
        </def-cat>
    
        <def-cat n="adj2pos">
            <cat-item tags="adj.pos"/>
            <cat-item tags="adj"/>
            <cat-item tags="adj.sint"/>
            <cat-item tags="adj.sint.*"/>
            <cat-item tags="adj.comp"/>
            <cat-item tags="adj.sup"/>
        </def-cat>
    
        <def-cat n="adjsup">
            <cat-item tags="adj.sup"/>
            <cat-item tags="adj.sint.sup"/>
        </def-cat>
    
    
    
        <def-cat n="num">
            <cat-item tags="num.*"/>
            <cat-item tags="num"/>
      
        </def-cat>
    
        <def-cat n="det"><!--Determinants i predeterminants, van anteposats en català -->
            <cat-item tags="det.dem.*"/>
            <cat-item tags="det.ind.*"/>
            <cat-item tags="det.def.*"/>
            <cat-item tags="det.pos.*"/>
            <cat-item tags="det.qnt.*"/>
            <cat-item tags="det.itg.*"/>
            <cat-item tags="det.ord.*"/>
            <cat-item tags="predet.*"/>
        </def-cat>
    
        <def-cat n="det2"><!--Poden anar precedits d'un altre determinant i anar després d'un genitiu saxó -->
            <cat-item tags="det.qnt.*"/>
            <cat-item tags="det.ord.*"/>
        </def-cat>
       
        <def-cat n="prep">
            <cat-item tags="pr"/>
        </def-cat>
    
    </section-def-cats>
    
    <section-def-attrs>
        <def-attr n="a_nom">
            <attr-item tags="n"/>
            <attr-item tags="n.acr"/>
            <attr-item tags="np.loc"/>
            <attr-item tags="np.ant"/>
            <attr-item tags="np.cog"/>
            <attr-item tags="np.al"/>
            <attr-item tags="adv"/>
        </def-attr>
    
        <def-attr n="a_np">
            <attr-item tags="np"/>
        </def-attr>
    
        <def-attr n="a_np_acr">
            <attr-item tags="np"/>
            <attr-item tags="acr"/>
        </def-attr>
    
        <def-attr n="a_adj">
            <attr-item tags="adj"/>
            <attr-item tags="adj.pos"/>
            <attr-item tags="vblex.pp"/>
            <attr-item tags="vbmod.pp"/>
            <attr-item tags="vblex.pron.pp"/>
            <attr-item tags="adjant"/>
        </def-attr>
    
    
        <def-attr n="grau_adj">
            <attr-item tags="comp"/>
            <attr-item tags="sup"/>
        </def-attr>
    
        <def-attr n="a_det">
            <attr-item tags="det.dem"/>
            <attr-item tags="det.ind"/>
            <attr-item tags="det.def"/>
            <attr-item tags="det.pos"/>
            <attr-item tags="det.qnt"/>
            <attr-item tags="det.itg"/>
            <attr-item tags="det.ord"/>
            <attr-item tags="adj.pos"/>
            <attr-item tags="num"/>
            <attr-item tags="predet"/>
        </def-attr>
    
        <def-attr n="a_prnpro">
            <attr-item tags="prn.pro"/>
        </def-attr>
        <def-attr n="a_prnenc">
            <attr-item tags="prn.enc"/>
        </def-attr>
        <def-attr n="a_num">
            <attr-item tags="num"/>
            <attr-item tags="num.percent"/>
            <attr-item tags="num.ord"/>
            <attr-item tags="num.mon"/>
        </def-attr>
    
        <def-attr n="a_verb">
            <attr-item tags="vblex"/>
            <attr-item tags="vblex.pron"/>
            <attr-item tags="vbhaver"/>
            <attr-item tags="vbser"/>
            <attr-item tags="vbmod"/>
        </def-attr>
    
        <def-attr n="a_have_aux">
            <attr-item tags="vbhaver"/>
        </def-attr>
    
        <def-attr n="a_pp">
            <attr-item tags="vblex.pp"/>
            <attr-item tags="vblex.pron.pp"/>
            <attr-item tags="vbser.pp"/>
            <attr-item tags="vbmod.pp"/>
        </def-attr>
    
    
        <def-attr n="a_aux">
            <attr-item tags="vaux"/>
        </def-attr>
    
        <def-attr n="a_prn">
            <attr-item tags="prn"/>
        </def-attr>
    
        <def-attr n="a_adv">
            <attr-item tags="adv"/>
            <attr-item tags="preadv"/>
            <attr-item tags="adv.itg"/>
            <attr-item tags="cnjadv"/>
        </def-attr>
    
        <def-attr n="a_rel">
            <attr-item tags="rel.nn"/>
            <attr-item tags="rel.an"/>
            <attr-item tags="rel.aa"/>
            <attr-item tags="rel.adv"/>
        </def-attr>
    
        <def-attr n="tipus_rel">
            <attr-item tags="nn"/>
            <attr-item tags="an"/>
            <attr-item tags="aa"/>
            <attr-item tags="adv"/>
        </def-attr>
    
        <def-attr n="tipus_prn">
            <attr-item tags="tn"/>
            <attr-item tags="obj"/>
            <attr-item tags="enc"/>
            <attr-item tags="itg"/>
            <attr-item tags="pos"/>
        </def-attr>
    
        <def-attr n="pers">
            <attr-item tags="p1"/>
            <attr-item tags="p2"/>
            <attr-item tags="p3"/>
            <attr-item tags="PD"/>
        </def-attr>
    
        <def-attr n="gen">
            <attr-item tags="m"/>
            <attr-item tags="f"/>
            <attr-item tags="mf"/>
            <attr-item tags="GD"/>
            <attr-item tags="nt"/>
        </def-attr>
    
    
    
        <def-attr n="gen_sense_mf">
            <attr-item tags="m"/>
            <attr-item tags="f"/>
            <attr-item tags="GD"/>
            <attr-item tags="nt"/>
        </def-attr>
    
        <def-attr n="gen_mf">
            <attr-item tags="mf"/>
        </def-attr>
    
        <def-attr n="nbr">
            <attr-item tags="sg"/>
            <attr-item tags="pl"/>
            <attr-item tags="sp"/>
            <attr-item tags="ND"/>
        </def-attr>
        <def-attr n="nbr_sense_sp">
            <attr-item tags="sg"/>
            <attr-item tags="pl"/>
            <attr-item tags="ND"/>
        </def-attr>
    
        <def-attr n="nbr_sp">
            <attr-item tags="sp"/>
        </def-attr>
    
    
        <def-attr n="temps">
            <attr-item tags="cni"/>
            <attr-item tags="fti"/>
            <attr-item tags="ifi"/>
            <attr-item tags="imp"/>
            <attr-item tags="pii"/>
            <attr-item tags="pis"/>
            <attr-item tags="inf"/>
            <attr-item tags="prs"/>
            <attr-item tags="pres"/>
            <attr-item tags="past"/>
            <attr-item tags="pri"/>
            <attr-item tags="pp"/>
            <attr-item tags="ger"/>
            <attr-item tags="pprs"/>
            <attr-item tags="subs"/>
        </def-attr>
    
    
    </section-def-attrs>
    
    <section-def-vars>
        <def-var n="genere" v="&amp;lt;m&amp;gt;"/>
        <def-var n="nombre" v="&amp;lt;sg&amp;gt;"/>
        <def-var n="interrogativa"/>
        <def-var n="exclamativa"/>
        <def-var n="neg"/>
        <def-var n="adjectiu1"/>
        <def-var n="adjectiu2"/>
        <def-var n="auxiliar"/>
        <def-var n="caseFirstWord"/>
        <def-var n="EOS" v="true"/>
        <def-var n="lema"/>
        <def-var n="lema_SV"/>
        <def-var n="verbfinal"/>
        <def-var n="chunk"/>
        <def-var n="temps_chunk"/>
        <def-var n="pers_chunk"/>
        <def-var n="nbr_chunk"/>
        <def-var n="nbr_qual"/>
        <def-var n="gen_chunk"/>
        <def-var n="gen_qual"/>
        <def-var n="gen_paraula"/>
        <def-var n="nbr_paraula"/>
        <def-var n="nbr_adj"/>
        <def-var n="pronom"/>
        <def-var n="pronomenc"/>
        <def-var n="paraula1"/>
        <def-var n="paraula2"/>
        <def-var n="tipus_verb"/>
        <def-var n="tipus_verb_imp"/>
        <def-var n="negative"/> <!-- BCN-->
        <def-var n="tipus_det"/>
    </section-def-vars>
    
    <section-def-lists>
    
        <def-list n="reportingverb"> <!-- BCN verbs que poden no portar el THAT -->
            <list-item v="say"/>
            <list-item v="admit"/>
            <list-item v="agree"/>
            <list-item v="decide"/>
            <list-item v="deny"/>
            <list-item v="explain"/>
            <list-item v="insist"/>
            <list-item v="promise"/>
            <list-item v="recommend"/>
            <list-item v="suggest"/>
            <list-item v="point"/>
            <list-item v="think"/>
            <list-item v="believe"/>
            <list-item v="hope"/>
            <list-item v="fear"/>
            <list-item v="suppose"/>
        </def-list>
    
        <def-list n="controlnouns"> <!-- BCN -->
            <list-item v="desire"/>
            <list-item v="order"/>
            <list-item v="need"/>
            <list-item v="right"/>
            <list-item v="duty"/>
            <list-item v="failure"/>
            <list-item v="power"/>
            <list-item v="wish"/>
            <list-item v="capacity"/>
            <list-item v="ability"/>
            <list-item v="hope"/>
            <list-item v="chance"/>
            <list-item v="honour"/>
            <list-item v="compulsion"/>
            <list-item v="responsibility"/>
            <list-item v="opportunity"/>
            <list-item v="idea"/>
            <list-item v="record"/>
            <list-item v="way"/>
            <list-item v="attempt"/>
            <list-item v="obligation"/>
            <list-item v="impulse"/>
            <list-item v="surprise"/>
            <list-item v="will"/>
            <list-item v="mean"/>
        </def-list>
    
        <def-list n="tractaments"> <!--potser s'hauria de canviar categoria i posar com a determinants -->
            <list-item v="Mr."/>
            <list-item v="Mrs."/>
            <list-item v="Ms."/>
            <list-item v="Dr."/>
        </def-list>
    
        <def-list n="days">
            <list-item v="Monday"/>
            <list-item v="Tuesday"/>
            <list-item v="Wednesday"/>
            <list-item v="Thursday"/>
            <list-item v="Friday"/>
            <list-item v="Saturday"/>
            <list-item v="Sunday"/>
        </def-list>
    
        <def-list n="adv_neg">
            <list-item v="not"/>
            <list-item v="never"/>
        </def-list>
    
    
        <def-list n="verbs_modals">
      
            <list-item v="can"/>
            <list-item v="must"/>
            <list-item v="should"/>
            <list-item v="may"/>
            <list-item v="might"/>
      
        </def-list>
    
        <def-list n="numeros25">
      
            <list-item v="1"/>
            <list-item v="2"/>
            <list-item v="3"/>
            <list-item v="4"/>
            <list-item v="5"/>
            <list-item v="6"/>
            <list-item v="7"/>
            <list-item v="8"/>
            <list-item v="9"/>
            <list-item v="10"/>
            <list-item v="11"/>
            <list-item v="12"/>
            <list-item v="13"/>
            <list-item v="14"/>
            <list-item v="15"/>
            <list-item v="16"/>
            <list-item v="17"/>
            <list-item v="18"/>
            <list-item v="19"/>
            <list-item v="one"/>
            <list-item v="two"/>
            <list-item v="three"/>
            <list-item v="four"/>
            <list-item v="five"/>
            <list-item v="six"/>
            <list-item v="seven"/>
            <list-item v="eight"/>
            <list-item v="nine"/>
            <list-item v="ten"/>
            <list-item v="eleven"/>
            <list-item v="twelve"/>
            <list-item v="thirteen"/>
            <list-item v="fourteen"/>
            <list-item v="fifteen"/>
            <list-item v="sixteen"/>
            <list-item v="seventeen"/>
            <list-item v="eighteen"/>
            <list-item v="nineteen"/>
      
        </def-list>
    
    </section-def-lists>
    
    <section-def-macros>
           
        <def-macro n="elimina_GDND" npar="1">
            <choose>
                <when>
                    <test>
                        <equal>
                            <clip pos="1" side="tl" part="gen"/>
                            <lit-tag v="GD"/>
                        </equal>
                    </test>
                    <let>
                        <clip pos="1" side="tl" part="gen"/>
                        <lit-tag v="m"/>
                    </let>
                </when>
            </choose>
            <choose>
                <when>
                    <test>
                        <equal>
                            <clip pos="1" side="tl" part="nbr"/>
                            <lit-tag v="ND"/>
                        </equal>
                    </test>
                    <let>
                        <clip pos="1" side="tl" part="nbr"/>
                        <lit-tag v="sg"/>
                    </let>
                </when>
            </choose>
        </def-macro>
                
        <def-macro n="f_concord3" npar="3"><!--1 = main parameter (typically noun); 2  = secondary parameter (typically adj or det). 3 = other secondary param. (typically det) -->
     <let>
       <var n="gen_chunk"/>
       <lit v=""/>
     </let>
     <let>
       <var n="nbr_chunk"/>
       <lit v=""/>
     </let>
     <choose><!--posa GD i ND a la paraula si no té valor per a gènere o per a nombre (excepte números) -->
       <when>
	 <test>
	   <equal>
	     <clip pos="2" side="tl" part="a_num"/>
	     <lit v=""/>
	   </equal>
	 </test>
	 <choose>
	   <when><!--si la paraula no té valor per a gènere (i en aquest cas, tampoc per a nombre) -->
	     <test>
	       <equal>
		 <clip pos="2" side="tl" part="gen"/>
		 <lit v=""/>
	       </equal>
	     </test>
	     <let>
	       <var n="paraula1"/>
	       <clip pos="2" side="tl" part="lemh"/>
	     </let>
	     <append n="paraula1">
	       <clip pos="2" side="tl" part="tags"/>
	       <lit-tag v="GD"/>
	       <lit-tag v="ND"/>
	       <clip pos="2" side="tl" part="lemq"/>
	     </append>
	     <let>
	       <clip pos="2" side="tl" part="whole"/>
	       <var n="paraula1"/>
	     </let>
	   </when>
	   <when><!--si la paraula no té valor per a nombre (però sí per a gènere, ja que sinó hauria entrat pel when anterior) -->
	     <test>
	       <equal>
		 <clip pos="2" side="tl" part="nbr"/>
		 <lit v=""/>
	       </equal>
	     </test>
	     <let>
	       <var n="paraula1"/>
	       <clip pos="2" side="tl" part="lemh"/>
	     </let>
	     <append n="paraula1">
	       <clip pos="2" side="tl" part="tags"/>
	       <lit-tag v="ND"/>
	       <clip pos="2" side="tl" part="lemq"/>
	     </append>
	     <let>
	       <clip pos="2" side="tl" part="whole"/>
	       <var n="paraula1"/>
	     </let>
	   </when>
	 </choose>
       </when>
     </choose>

     <choose><!--posa GD i ND a la paraula si no té valor per a gènere o per a nombre (excepte números) -->
       <when>
	 <test>
	   <equal>
	     <clip pos="3" side="tl" part="a_num"/>
	     <lit v=""/>
	   </equal>
	 </test>


	 <choose>
	   <when><!--si la paraula no té valor per a gènere (i en aquest cas, tampoc per a nombre) -->
	     <test>
	       <equal>
		 <clip pos="3" side="tl" part="gen"/>
		 <lit v=""/>
	       </equal>
	     </test>
	     <let>
	       <var n="paraula1"/>
	       <clip pos="3" side="tl" part="lemh"/>
	     </let>
	     <append n="paraula1">
	       <clip pos="3" side="tl" part="tags"/>
	       <lit-tag v="GD"/>
	       <lit-tag v="ND"/>
	       <clip pos="3" side="tl" part="lemq"/>
	     </append>
	     <let>
	       <clip pos="3" side="tl" part="whole"/>
	       <var n="paraula1"/>
	     </let>
	   </when>
	   <when><!--si la paraula no té valor per a nombre (però sí per a gènere, ja que sinó hauria entrat pel when anterior) -->
	     <test>
	       <equal>
		 <clip pos="3" side="tl" part="nbr"/>
		 <lit v=""/>
	       </equal>
	     </test>
	     <let>
	       <var n="paraula1"/>
	       <clip pos="3" side="tl" part="lemh"/>
	     </let>
	     <append n="paraula1">
	       <clip pos="3" side="tl" part="tags"/>
	       <lit-tag v="ND"/>
	       <clip pos="3" side="tl" part="lemq"/>
	     </append>
	     <let>
	       <clip pos="3" side="tl" part="whole"/>
	       <var n="paraula1"/>
	     </let>
	   </when>
	 </choose>
       </when>
     </choose>




<!--OPERACIONS DE GÈNERE -->
      <choose>
	<when>
	  <test>
	      <equal>
		<clip pos="2" side="tl" part="gen"/>
		<lit-tag v="GD"/>
	      </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="GD"/>
		</equal>
	      </test>
	      <let>
		<var n="gen_chunk"/>
		<lit-tag v="GD"/>
	      </let>
	    </when>
	    <when>
	      <test>
		<not><!--si gènere de pos 1 és masc o fem -->
		  <or>
		    <equal>
		      <clip pos="1" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="tl" part="gen"/>
		      <lit v=""/>
		    </equal>
		  </or>
		</not>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="gen"/>
		<clip pos="1" side="tl" part="gen"/>
	      </let>
	      <let>
		<var n="gen_chunk"/>
		<clip pos="1" side="tl" part="gen"/>
	      </let>
	    </when>
	    <otherwise><!--si gènere pos 1 és mf -->
	      <let>
		<var n="gen_chunk"/>
		<lit-tag v="GD"/>
	      </let>
	    </otherwise>
	  </choose>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	      <equal>
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="GD"/>
	      </equal>
	  </test>
	  <let>
	    <var n="gen_chunk"/>
	    <lit-tag v="GD"/>
	  </let>
	</when>
	<when>
	  <test>
	    <not>
	      <or>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="mf"/>
		</equal>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit v=""/>
		</equal>
	      </or>
	    </not>
	  </test>
	  <let>
	    <var n="gen_chunk"/>
	    <clip pos="1" side="tl" part="gen"/>
	  </let>
	</when>
	<otherwise><!--si gènere de pos 1 és mf -->
	  <choose>
	    <when>
	      <test><!--si el gènere de pos 2 és GD, el gènere del chunk serà tb GD (deixant pos 1 com a mf) per si es pot assignar gènere a pos 2 (p. ex. 'the pacient - el/la pacient') -->
		<and>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="gen"/>
		      <lit-tag v="GD"/>
		    </equal>
		  </not>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="gen"/>
		      <lit-tag v="GD"/>
		    </equal>
		  </not>
		</and>
	      </test>
	      <let>
		<var n="gen_chunk"/>
		<clip pos="1" side="tl" part="gen"/>
	      </let>
	    </when>
	  </choose>
	</otherwise>
      </choose>
      <choose><!--i aquí les operacions per a posició 3. -->
	<when>
	  <test>
	    <equal>
		<clip pos="3" side="tl" part="gen"/>
		<lit-tag v="GD"/>
	    </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<not>
		  <equal>
		    <var n="gen_chunk"/>
		    <lit v=""/>
		  </equal>
		</not>
	      </test>
	      <let>
		<clip pos="3" side="tl" part="gen"/>
		<var n="gen_chunk"/>
	      </let>
	    </when>
	    <otherwise>
	       <let>
		 <var n="gen_chunk"/>
		 <lit-tag v="GD"/>
	       </let>
	    </otherwise>
	  </choose>
	</when>
      </choose>

<!--OPERACIONS DE NOMBRE -->

  <choose>
	<when>
	  <test>
	      <equal>
		<clip pos="2" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="ND"/>
		</equal>
	      </test>
	      <let>
		<var n="nbr_chunk"/>
		<lit-tag v="ND"/>
	      </let>
	    </when>
	    <when>
	      <test>
		<not><!--si nombre de pos 1 és masc o fem -->
		  <or>
		    <equal>
		      <clip pos="1" side="tl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="tl" part="nbr"/>
		      <lit v=""/>
		    </equal>
		  </or>
		</not>
	      </test>
	      <let>
		<clip pos="2" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </let>
	      <let>
		<var n="nbr_chunk"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </let>
	    </when>
	    <otherwise><!--si nombre pos 1 és sp o no té nombre -->
	      <let>
		<var n="nbr_chunk"/>
		<lit-tag v="ND"/>
	      </let>
	    </otherwise>
	  </choose>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	  </test>
	  <let>
	    <var n="nbr_chunk"/>
	    <lit-tag v="ND"/>
	  </let>
	</when>
	<when>
	  <test>
	    <not>
	      <or>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
		<equal>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit v=""/>
		</equal>
	      </or>
	    </not>
	  </test>
	  <let>
	    <var n="nbr_chunk"/>
	    <clip pos="1" side="tl" part="nbr"/>
	  </let>
	</when>
	<otherwise><!--si nombre de pos 1 és sp -->
	  <choose>
	    <when>
	      <test>
		<or>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </test>
	      <let>
		<var n="nbr_chunk"/>
		<clip pos="2" side="tl" part="nbr"/>
	      </let>
	    </when>
	    <when>
	      <test><!--si pos 2 és també sp-->
		<equal>
		  <clip pos="2" side="tl" part="nbr"/>
		  <lit-tag v="sp"/>
		</equal>
	      </test>
	      <choose><!--si pos 3 no és sp o ND, assigna gènere de pos 3 al chunk-->
		<when>
		  <test>
		    <or>
		      <equal>
			<clip pos="3" side="tl" part="nbr"/>
			<lit-tag v="sg"/>
		      </equal>
		      <equal>
			<clip pos="3" side="tl" part="nbr"/>
			<lit-tag v="pl"/>
		      </equal>
		    </or>
		  </test>
		  <let>
		    <var n="nbr_chunk"/>
		    <clip pos="3" side="tl" part="nbr"/>
		  </let>
		</when>
	      </choose>
	    </when>
	    <when>
	      <test><!--si pos 2 no té nombre (ex: xifres) -->
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit v=""/>
		  </equal>
	      </test>
	      <choose>
		<when>
		  <test>
		    <or>
		      <equal>
			<clip pos="3" side="tl" part="nbr"/>
			<lit-tag v="sg"/>
		      </equal>
		      <equal>
			<clip pos="3" side="tl" part="nbr"/>
			<lit-tag v="pl"/>
		      </equal>
		    </or>
		  </test>
		  <let>
		    <var n="nbr_chunk"/>
		    <clip pos="3" side="tl" part="nbr"/>
		  </let>
		</when>
		<otherwise>
		  <let> <!-- el nombre del chunk serà sp, que no estarà enllaçat amb la posició 2 (pq no té valor per a l'atribut nbr"-->
		    <var n="nbr_chunk"/>
		    <clip pos="1" side="tl" part="nbr"/>
		  </let>
		</otherwise>
	      </choose>
	    </when>
	  </choose>
	</otherwise>
      </choose>
       <choose><!--i aquí les operacions per a posició 3. -->
	<when>
	  <test>
	    <equal>
		<clip pos="3" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	    </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<not>
		  <equal>
		    <var n="nbr_chunk"/>
		    <lit v=""/>
		  </equal>
		</not>
	      </test>
	      <let>
		<clip pos="3" side="tl" part="nbr"/>
		<var n="nbr_chunk"/>
	      </let>
	    </when>
	    <otherwise>
	       <let>
		 <var n="nbr_chunk"/>
		 <lit-tag v="ND"/>
	       </let>
	    </otherwise>
	  </choose>
	</when>
      </choose>
</def-macro>
        
    </section-def-macros>
    
    <section-rules>
    
       <rule comment="REGLA: MONTH NUM, NUM (July 23, 2010 → 23 de juliol de 2010)">
            <pattern>
                <pattern-item n="months"/>
                <pattern-item n="num"/>
                <pattern-item n="coma"/>
                <pattern-item n="num"/>
            </pattern>
            <action>
                <call-macro n="firstWord">
                    <with-param pos="1"/>
                </call-macro>
                <choose>
                    <when>
                        <test>
                            <equal>
                                <clip pos="1" side="sl" part="lem"/>
                                <lit v="March"/>
                            </equal>
                        </test>
                        <let>
                            <clip pos="1" side="tl" part="lem"/>
                            <lit v="març"/>
                        </let>
                        <choose>
                            <when>
                                <test>
                                    <equal>
                                        <clip pos="1" side="sl" part="a_nom"/>
                                        <lit-tag v="np.cog"/>
                                    </equal>
                                </test>
                                <let>
                                    <clip pos="1" side="tl" part="a_nom"/>
                                    <lit-tag v="n"/>
                                </let>
                                <let>
                                    <clip pos="1" side="tl" part="gen"/>
                                    <lit-tag v="m"/>
                                </let>
                                <let>
                                    <clip pos="1" side="tl" part="nbr"/>
                                    <lit-tag v="sg"/>
                                </let>
                            </when>
                        </choose>
                    </when>
                </choose>
                <out>
                    <chunk name="month_num_cm_num" case="caseFirstWord">
                        <tags>
                            <tag>
                                <clip pos="2" side="tl" part="a_adv"/>
                            </tag>
                            <tag>
                                <var n="neg"/>
                            </tag>
                        </tags>
                        <lu>
                            <clip pos="2" side="tl" part="whole"/>
                        </lu>
                        <b pos="1"/>
                        <lu>
                            <lit v="de"/>
                            <lit-tag v="pr"/>
                        </lu>
                        <b/>
                        <lu>
                            <clip pos="1" side="tl" part="whole"/>
                        </lu>
                        <b/>
                        <lu>
                            <lit v="de"/>
                            <lit-tag v="pr"/>
                        </lu>
                        <b pos="3"/>
                        <lu>
                            <clip pos="4" side="tl" part="whole"/>
                        </lu>
                    </chunk>
                </out>
            </action>
        </rule>
                
    </section-rules> 
    
</transfer>