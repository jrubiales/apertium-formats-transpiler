<?xml version="1.0" encoding="UTF-8"?> <!-- -*- nxml -*- -->
<transfer default="chunk">
    
    <section-def-macros>

        <def-macro n="elimina_GDND" npar="1">
            <choose>
                <when>
                    <test>
                        <equal>
                            <clip pos="1" side="tl" part="gen"/>
                            <lit-tag v="GD"/>
                        </equal>
                    </test>
                    <let>
                        <clip pos="1" side="tl" part="gen"/>
                        <lit-tag v="m"/>
                    </let>
                </when>
                <otherwise>
                    <let>
                        <clip pos="1" side="tl" part="gen"/>
                        <lit-tag v="m"/>
                    </let>
                </otherwise>
            </choose>
            <choose>
                <when>
                    <test>
                        <equal>
                            <clip pos="1" side="tl" part="nbr"/>
                            <lit-tag v="ND"/>
                        </equal>
                    </test>
                    <let>
                        <clip pos="1" side="tl" part="nbr"/>
                        <lit-tag v="sg"/>
                    </let>
                </when>
            </choose>
        </def-macro>
    </section-def-macros>
    
    <section-rules>
        <rule comment="REGLA: PRONOM">
            <pattern>
                <pattern-item n="prnsubj"/>
            </pattern>
            <action>
                <call-macro n="firstWord">
                    <with-param pos="1"/>
                </call-macro>
                <choose>
                    <when>
                        <test>
                            <not>
                                <equal caseless="yes">
                                    <clip pos="1" side="sl" part="lem"/>
                                    <lit v="prpers"/>
                                </equal>
                            </not>
                        </test>
                        <let>
                            <var n="lema"/>
                            <lit v="prnsubj2"/><!--lemes 'we all' etc, són subjectes però no desapareixen en el t2x. -->
                        </let>
                    </when>
                    <otherwise>
                        <let>
                            <var n="lema"/>
                            <lit v="prnsubj"/>
                        </let>
                    </otherwise>
                </choose>
                <out>
                    <chunk namefrom="lema" case="caseFirstWord">
                        <tags>
                            <tag>
                                <lit-tag v="SN"/>
                            </tag>
                            <tag>
                                <clip pos="1" side="tl" part="tipus_prn"/>
                            </tag>
                            <tag>
                                <clip pos="1" side="tl" part="pers"/>
                            </tag>
                            <tag>
                                <clip pos="1" side="tl" part="gen"/>
                            </tag>
                            <tag>
                                <clip pos="1" side="tl" part="nbr"/>
                            </tag>
                        </tags>
                        <lu>
                            <clip pos="1" side="tl" part="lem"/>
                            <clip pos="1" side="tl" part="a_prn"/>
                            <clip pos="1" side="tl" part="tipus_prn" link-to="2"/>
                            <clip pos="1" side="tl" part="pers"/>
                            <clip pos="1" side="tl" part="gen"/>
                            <clip pos="1" side="tl" part="nbr"/>
                        </lu>
                    </chunk>
                </out>
            </action>
        </rule>
    </section-rules>
</transfer>
<!--
Resources:
    http://wiki.apertium.org/wiki/Chunking:_A_full_example
    http://wiki.apertium.org/wiki/Chunking
    http://wiki.apertium.org/wiki/Apertium_New_Language_Pair_HOWTO#Transfer_rules
    http://wiki.apertium.org/wiki/A_long_introduction_to_transfer_rules
    http://wiki.apertium.org/wiki/Transfer#Adding_structural_transfer_.28grammar.29_rules
-->
